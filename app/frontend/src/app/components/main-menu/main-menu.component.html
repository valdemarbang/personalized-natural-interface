<div class="min-h-screen bg-slate-50 flex flex-col">
    <!-- Top Bar -->
    <div class="bg-white shadow-sm px-6 py-4 flex justify-between items-center z-10">
        <h1 class="text-xl font-bold text-slate-800">Personalized Natural Interface</h1>
        
        <div class="flex items-center gap-4">
            <div class="flex flex-col items-end">
                <span class="text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1">Current Profile</span>
                <p-select 
                    [options]="profiles" 
                    [(ngModel)]="selectedProfile" 
                    optionLabel="label" 
                    (onChange)="onProfileChange()" 
                    placeholder="Select a Profile"
                    [style]="{'width': '250px'}"
                    size="small">
                </p-select>
            </div>
            <div class="h-8 w-px bg-slate-200 mx-2"></div>
            <p-button icon="pi pi-plus" label="New" (onClick)="createNewProfile()" size="small" severity="secondary" [text]="true"></p-button>
            <p-button icon="pi pi-trash" (onClick)="deleteProfile()" size="small" severity="danger" [text]="true" pTooltip="Delete Profile"></p-button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 p-6 overflow-auto">
        
        <!-- Dashboard View -->
        <div *ngIf="activeView === 'dashboard'" class="max-w-6xl mx-auto">
            <div class="mb-8">
                <h2 class="text-3xl font-light text-slate-800 mb-2">Welcome, <span class="font-semibold">{{ selectedProfile?.value || 'Guest' }}</span></h2>
                <p class="text-slate-500">Select an action to get started with the interface.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- STT Card -->
                <p-card header="Speech to Text" subheader="Transcribe Audio" styleClass="h-full shadow-md hover:shadow-lg transition-shadow cursor-pointer" (click)="startStt()">
                    <ng-template pTemplate="header">
                        <div class="h-32 bg-blue-50 flex items-center justify-center text-blue-500">
                            <i class="pi pi-microphone text-5xl"></i>
                        </div>
                    </ng-template>
                    <p class="m-0 text-slate-600">
                        Convert spoken language into text using the {{ selectedProfile?.value ? 'personalized' : 'base' }} model.
                    </p>
                    <ng-template pTemplate="footer">
                        <p-button label="Start STT" icon="pi pi-arrow-right" iconPos="right" styleClass="w-full"></p-button>
                    </ng-template>
                </p-card>

                <!-- TTS Card -->
                <p-card header="Text to Speech" subheader="Generate Audio" styleClass="h-full shadow-md hover:shadow-lg transition-shadow cursor-pointer" (click)="startTts()">
                    <ng-template pTemplate="header">
                        <div class="h-32 bg-purple-50 flex items-center justify-center text-purple-500">
                            <i class="pi pi-volume-up text-5xl"></i>
                        </div>
                    </ng-template>
                    <p class="m-0 text-slate-600">
                        Generate natural-sounding speech from text input.
                    </p>
                    <ng-template pTemplate="footer">
                        <p-button label="Start TTS" icon="pi pi-arrow-right" iconPos="right" styleClass="w-full" severity="help"></p-button>
                    </ng-template>
                </p-card>

                <!-- Training Card (Only if profile selected) -->
                <p-card *ngIf="selectedProfile?.value" header="Fine-tuning" subheader="Improve Model" styleClass="h-full shadow-md hover:shadow-lg transition-shadow cursor-pointer" (click)="startTrain()">
                    <ng-template pTemplate="header">
                        <div class="h-32 bg-green-50 flex items-center justify-center text-green-500">
                            <i class="pi pi-cog text-5xl"></i>
                        </div>
                    </ng-template>
                    <p class="m-0 text-slate-600">
                        Record additional samples to fine-tune the model for better accuracy.
                    </p>
                    <ng-template pTemplate="footer">
                        <p-button label="Train Model" icon="pi pi-arrow-right" iconPos="right" styleClass="w-full" severity="success"></p-button>
                    </ng-template>
                </p-card>
                
                <!-- Create Profile Card (If no profile) -->
                <p-card *ngIf="!selectedProfile?.value" header="Create Profile" subheader="Personalize" styleClass="h-full shadow-md hover:shadow-lg transition-shadow cursor-pointer border-dashed border-2 border-slate-300 bg-slate-50" (click)="createNewProfile()">
                    <ng-template pTemplate="header">
                        <div class="h-32 flex items-center justify-center text-slate-400">
                            <i class="pi pi-user-plus text-5xl"></i>
                        </div>
                    </ng-template>
                    <p class="m-0 text-slate-600">
                        Create a personalized profile to adapt the models to your voice.
                    </p>
                    <ng-template pTemplate="footer">
                        <p-button label="Create Profile" icon="pi pi-plus" styleClass="w-full" severity="secondary" [outlined]="true"></p-button>
                    </ng-template>
                </p-card>
            </div>
        </div>

        <!-- Sub-views -->
        <div *ngIf="activeView !== 'dashboard'" class="max-w-6xl mx-auto h-full flex flex-col">
            <div class="mb-4 flex items-center gap-2">
                <p-button icon="pi pi-arrow-left" (onClick)="backToDashboard()" [text]="true" label="Back to Dashboard"></p-button>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm p-6 flex-1 overflow-hidden border border-slate-100">
                <app-stt-manager *ngIf="activeView === 'stt'"></app-stt-manager>
                <app-tts-menu *ngIf="activeView === 'tts'" (close)="backToDashboard()"></app-tts-menu>
                <app-write-own-prompt *ngIf="activeView === 'train'" (close)="backToDashboard()"></app-write-own-prompt>
            </div>
        </div>
    </div>
</div>